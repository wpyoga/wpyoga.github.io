<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="William&#39;s GitHub Pages RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="William&#39;s GitHub Pages Atom Feed"><title data-react-helmet="true">Making a new blog with Docusaurus v2 | William&#x27;s GitHub Pages</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wpyoga.github.io/blog/2021/06/12/docusaurus-install"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Making a new blog with Docusaurus v2 | William&#x27;s GitHub Pages"><meta data-react-helmet="true" name="description" content="To make a new blog with the upcoming Docusaurus 2, we need understand how GitHub Pages works, and also pay attention to several caveats."><meta data-react-helmet="true" property="og:description" content="To make a new blog with the upcoming Docusaurus 2, we need understand how GitHub Pages works, and also pay attention to several caveats."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-06-12T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="docusaurus,blog"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wpyoga.github.io/blog/2021/06/12/docusaurus-install"><link data-react-helmet="true" rel="alternate" href="https://wpyoga.github.io/blog/2021/06/12/docusaurus-install" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wpyoga.github.io/blog/2021/06/12/docusaurus-install" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.935e0c88.css">
<link rel="preload" href="/assets/js/runtime~main.4adf4b77.js" as="script">
<link rel="preload" href="/assets/js/main.10af240a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">William&#x27;s GitHub Pages site</b></a><a class="navbar__item navbar__link" href="/docs/intro">Docusaurus Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://wpyoga.github.io/boto3-docs-reformat/html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Boto3 Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">All posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/03/17/migrating-windows-10">Migrating Windows 10 from HDD to SSD using Linux</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/02/14/show-in-folder">Show Items in Folder</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/27/libvirt-networking">Libvirt Networking Configuration</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/26/installing-proxmox-ve-on-debian-bullseye">Installing Proxmox VE on Debian Bullseye</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/24/vaccine-certrificate">Vaccination Certificate Download Via PeduliLindungi</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/22/server-wifi-disconnected">When My Server&#x27;s Wi-Fi Got Disconnected</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/19/deciphering-aptitude-search-results">Deciphering Aptitude Search Results</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2022/01/17/installing-openvz-6">Installing OpenVZ 6</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/30/oracle-cloud-instance-ipv6">Enabling IPv6 on Oracle Cloud Instance</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/26/dnf-ipv6">Using DNF on an IPv6-only host</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/10/15/vue-component-tag-name">Vue.js Component vs HTML Tag Names</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/21/nvm-sdkman-fast-loading">Fast Loading for `nvm` and SDKMAN!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/11/bash-slow-start">Bash Shell Slow Start-up</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/11/manual-profiling-bash-script">Manual Profiling of Bash Script Execution</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/07/10/bashrc-directory">Using a `.bashrc.d` directory instead of just `.bashrc`</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/16/github-main-branch">GitHub `main` branch</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/13/possible-webpack-dirname-bug">Possible dirname bug in Webpack</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/06/12/docusaurus-deploy">Deploying Docusaurus site to GitHub the easy way</a></li><li class="sidebarItem_2UVv"><a aria-current="page" class="sidebarItemLink_1RT6 sidebarItemLinkActive_12pM" href="/blog/2021/06/12/docusaurus-install">Making a new blog with Docusaurus v2</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/2021/05/08/inotifywait-problem">Problem with inotifywait, VSCode, and Maven</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">Making a new blog with Docusaurus v2</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2021-06-12T00:00:00.000Z" itemprop="datePublished">June 12, 2021</time></div></header><div class="markdown" itemprop="articleBody"><p>To make a new blog with the upcoming Docusaurus 2, we need understand how GitHub Pages works, and also pay attention to several caveats.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="how-github-pages-works-and-how-to-use-it">How GitHub Pages works and how to use it<a class="hash-link" href="#how-github-pages-works-and-how-to-use-it" title="Direct link to heading">â€‹</a></h2><p>GitHub Pages sites serve its root as static content from a directory on a selected branch of the special repository <code>_username_.github.io</code> or <code>_organization_.github.io</code>. If there is an <code>index.html</code> file, then it will be used. Otherwise, <code>README.md</code> will be served -- but see <a href="#how-github-pages-really-works">this note</a>.</p><p>For example, I have the username <code>wpyoga</code> on GitHub. My GitHub Pages site is <code>wpyoga.github.io</code>, and it serves its root <code>https://wpyoga.github.io/</code> as static content from the <code>master</code> branch of the repository <code>wpyoga.github.io</code> in my account.</p><p>As of 2021-06-12, the special repository <code>_username_.github.io</code> defaults to serving GitHub Pages from the <code>master</code> branch, and other repositories default to serving from the <code>gh-pages</code> branch. This means that:</p><ul><li><p>on repositories other than the special repository, if you push to the <code>gh-pages</code> branch, and no branch has been configured to serve the GitHub Pages site, then GitHub will automatically designate the <code>gh-pages</code> branch for GitHub Pages, and serve the site from the repository&#x27;s root directory.</p></li><li><p>on the special repository, pushing to the <code>master</code> branch will trigger the same mechanism. Pushing to the <code>gh-pages</code> branch will not trigger this mechanism.</p></li></ul><p>Note that this designated branch contains the generated static content, not the raw Markdown and the sources. So if you use Docusaurus (or Jekyll) to generate the static site from Markdown documents, then the designated branch should not contain the sources, but only the generated (built) content. Docusaurus follows GitHub Pages&#x27; convention, so by default it will try to publish the generated content in the <code>build</code> directory of the source tree to the designated branch, according to the repository name.</p><p>However, my preferred method is to use the <code>master</code> branch for the source tree, and push my generated content to the <code>gh-pages</code> branch. Note that for the special repository, the <code>gh-pages</code> branch doesn&#x27;t trigger the automatic mechanism above, so I had to <a href="https://github.com/wpyoga/wpyoga.github.io/settings/branches" target="_blank" rel="noopener noreferrer">manually configure it</a>. Alternatively, you can also <a href="#following-github-conventions">follow GitHub conventions</a>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="deploy">Deploy<a class="hash-link" href="#deploy" title="Direct link to heading">â€‹</a></h3><p><code>yarn deploy</code> will build and deploy the site:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ GIT_USER=wpyoga DEPLOYMENT_BRANCH=gh-pages USE_SSH=true yarn deploy</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It doesn&#x27;t look pretty, and it&#x27;s not easy to remember. Fortunately, I have <a href="/blog/2021/06/12/docusaurus-deploy">a better solution</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="further-discussion">Further discussion<a class="hash-link" href="#further-discussion" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="manually-deploying-to-a-branch">Manually deploying to a branch<a class="hash-link" href="#manually-deploying-to-a-branch" title="Direct link to heading">â€‹</a></h3><p>First, checkout the site serving branch (<code>gh-pages</code> in our example) to a temporary directory:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git worktree add --no-checkout /tmp/build gh-pages</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Generate the site and copy it into the temporary directory:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cp -rT build /tmp/build</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Notes:</p><ul><li>we cannot use <code>yarn build --out-dir /tmp/build</code> because this will remove the <code>.git</code> file inside that directory</li><li>with the <code>-T</code> option, <code>cp</code> copies the contents <code>build</code> directory into <code>/tmp/build</code>, as opposed to copying the <code>build</code> directory itself</li><li>there is a better way if you want to use a script, see the end of this section</li></ul><p>Push the files to GitHub:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ cd /tmp/build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git add .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git commit -m &quot;new build at $(date)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd -</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Remove the temporary directory:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git worktree remove /tmp/build</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Here&#x27;s a script to automate the whole process:</p><div class="codeBlockContainer_K1bP language-shell theme-code-block"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TMPDIR</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable" style="color:#36acaa">mktemp -d tmp-XXXXX</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">TMPDIR2</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable" style="color:#36acaa">mktemp -d tmp-XXXXX</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> worktree </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> --force --no-checkout </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> gh-pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">/.git&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR2}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> build --out-dir </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR2}</span><span class="token string" style="color:#e3116c">/.git&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rmdir</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR2}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cd </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#e3116c">&quot;new build at </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> push</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> worktree remove </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${TMPDIR}</span><span class="token string" style="color:#e3116c">&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note: we use a custom template because there <a href="/blog/2021/06/13/possible-webpack-dirname-bug">might be a bug</a> that causes <code>yarn build</code> to fail.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="another-method-of-deploying-manually-doesnt-work-well">Another method of deploying manually doesn&#x27;t work well<a class="hash-link" href="#another-method-of-deploying-manually-doesnt-work-well" title="Direct link to heading">â€‹</a></h3><p>After building the site, push the <code>build</code> directory to a new <code>gh-pages</code> branch:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git subtree split -P build -b gh-pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Created branch &#x27;gh-pages&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d7d2eaa20128724d8234c817151c16d0931dec98</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git push origin gh-pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enumerating objects: 117, done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Counting objects: 100% (117/117), done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Delta compression using up to 4 threads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compressing objects: 100% (83/83), done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Writing objects: 100% (117/117), 322.93 KiB | 1.02 MiB/s, done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total 117 (delta 29), reused 54 (delta 8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: Resolving deltas: 100% (29/29), done.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: Create a pull request for &#x27;gh-pages&#x27; on GitHub by visiting:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote:      https://github.com/wpyoga/wpyoga.github.io/pull/new/gh-pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To github.com:wpyoga/wpyoga.github.io.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * [new branch]      gh-pages -&gt; gh-pages</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Because this repository is the special <code>_username_.github.io</code> repository, GitHub doesn&#x27;t treat the <code>gh-pages</code> branch here as being special. So I need to <a href="https://github.com/wpyoga/wpyoga.github.io/settings/pages" target="_blank" rel="noopener noreferrer">manually specify</a> the <code>gh-pages</code> branch to serve the site root.</p><p>The problem is, now I cannot update the <code>gh-pages</code> branch. I need to read Docusaurus&#x27; source code in <code>lib/deploy.ts</code> and see how they manage to make <code>yarn deploy</code> work. Looking at the log output, it seems that Docusaurus clones the <code>gh-pages</code> branch to a temporary location, deletes everything, overwrites the content with new files, and then pushes the changes back to the remote branch.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="how-github-pages-really-works">How GitHub Pages really works<a class="hash-link" href="#how-github-pages-really-works" title="Direct link to heading">â€‹</a></h3><p>I&#x27;m not 100% sure how it works.</p><p>Docusaurus mentions that <a href="https://docusaurus.io/docs/deployment#deploying-to-github-pages" target="_blank" rel="noopener noreferrer">GitHub will run the generated files through Jekyll</a>, so a <code>.nojekyll</code> file is added to each directory, to prevent the removal of files whose names have a leading <code>_</code> (underscore).</p><p>I&#x27;ve also tried messing around with the designated repository, renaming index.html and adding README.md, but the Docusaurus site is still being served (a &quot;page not found&quot; message can be seen upon initial loading, but then disappears after a split second).</p><p>Since this is a static site, index.php is not served (at all).</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="serving-github-pages-from-a-subdirectory">Serving GitHub Pages from a subdirectory<a class="hash-link" href="#serving-github-pages-from-a-subdirectory" title="Direct link to heading">â€‹</a></h3><p>We can actually use a single branch for both the source code and generated content -- GitHub allows us to specify the <code>/docs</code> subdirectory as the content location. However, this is not easily adaptable to Docusaurus, where <code>docs</code> stores Markdown files, and the generated content is actually in <code>build</code>.</p><p>Unfortunately, as of 2021-06-12, GitHub doesn&#x27;t allow the use of any other subdirectory for this purpose.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="following-github-conventions">Following GitHub conventions<a class="hash-link" href="#following-github-conventions" title="Direct link to heading">â€‹</a></h3><p>For the special repository, following GitHub&#x27;s conventions is somewhat counterintuitive. You would usually have the source code in the <code>master</code> branch, and in this case you cannot deploy to the <code>master</code> branch since it will overwrite all the source code. In this case, the solution is to move the source code to another branch, say <code>source</code>, work on that branch, and deploy to the <code>master</code> branch.</p><p>I pushed the source code from the <code>master</code> branch to the <code>source</code> branch.</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git branch source</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git push --set-upstream origin source</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Then I would need to delete the <code>master</code> branch. The problem is, GitHub didn&#x27;t want to delete the <code>master</code> branch:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git push --delete origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To github.com:wpyoga/wpyoga.github.io.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ! [remote rejected] master (refusing to delete the current branch: refs/heads/master)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">error: failed to push some refs to &#x27;git@github.com:wpyoga/wpyoga.github.io.git&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It turns out that GitHub just doesn&#x27;t want to delete the default branch. Note that this concept of &quot;default branch&quot; is not from git, but rather from GitHub.</p><p>Anyway, I changed the <a href="https://github.com/wpyoga/wpyoga.github.io/settings/branches" target="_blank" rel="noopener noreferrer">default branch</a> to <code>source</code> for now, and now I can delete the <code>master</code> branch:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git push --delete origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To github.com:wpyoga/wpyoga.github.io.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - [deleted]         master</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now, <code>yarn deploy</code> will push the generated content to the <code>master</code> branch of the special repository.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="moving-source-code-back-to-the-master-branch">Moving source code back to the master branch<a class="hash-link" href="#moving-source-code-back-to-the-master-branch" title="Direct link to heading">â€‹</a></h3><p>After I moved the source code from the <code>master</code> branch to the <code>source</code> branch, I found out that I can actually deploy to another branch instead.
So I wanted to move the source code back to the <code>master</code> branch.</p><p>I deleted the <code>master</code> branch, renamed the <code>source</code> branch to <code>master</code>, and then pushed the changes:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git branch -D master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Deleted branch master (was 67c2b46).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git branch -m source master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On branch master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your branch is up to date with &#x27;origin/source&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git push origin HEAD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total 0 (delta 0), reused 0 (delta 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: Create a pull request for &#x27;master&#x27; on GitHub by visiting:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote:      https://github.com/wpyoga/wpyoga.github.io/pull/new/master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To github.com:wpyoga/wpyoga.github.io.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * [new branch]      HEAD -&gt; master</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At this point the <code>source</code> branch was useless, so I changed the default branch to <code>master</code> again (on GitHub), then deleted the remote <code>source</code> branch:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git push --delete origin source</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To github.com:wpyoga/wpyoga.github.io.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - [deleted]         source</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At this point the remote branch has been deleted, but the local repo still references the old one:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On branch master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your branch is based on &#x27;origin/source&#x27;, but the upstream is gone.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (use &quot;git branch --unset-upstream&quot; to fixup)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>So I dutifully followed the recommendations:</p><div class="codeBlockContainer_K1bP language-shell-session theme-code-block"><div class="codeBlockContent_hGly shell-session"><pre tabindex="0" class="prism-code language-shell-session codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ git branch --unset-upstream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git push --set-upstream origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Branch &#x27;master&#x27; set up to track remote branch &#x27;master&#x27; from &#x27;origin&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Everything up-to-date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">On branch master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your branch is up to date with &#x27;origin/master&#x27;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="changing-usernames-or-organization-names">Changing usernames or organization names<a class="hash-link" href="#changing-usernames-or-organization-names" title="Direct link to heading">â€‹</a></h3><p>I used to have the username <code>wpyh</code>, but I changed it a few weeks ago.</p><p>When I had the username <code>wpyh</code>, if I had created a repository named <code>wpyh.github.io</code>, then GitHub would have made a subdomain for me: <code>wpyh.github.io</code>. This is a special repo, which serves as the source of the GitHub Pages site hosted at <code>wpyh.github.io</code> from its <code>main</code> branch by default.</p><p>When I changed my username from <code>wpyh</code> to <code>wpyoga</code>, I would have had to rename the aforementioned repository to <code>wpyoga.github.io</code>. GitHub would have changed the custom subdomain to <code>wpyoga.github.io</code>, and the old custom subdomain would have been deleted.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/docusaurus">docusaurus</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/blog">blog</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/wpyoga/wpyoga.github.io/edit/master/blog/2021-06-12-docusaurus-install.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2021/06/12/docusaurus-deploy"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« <!-- -->Deploying Docusaurus site to GitHub the easy way</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2021/05/08/inotifywait-problem"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Problem with inotifywait, VSCode, and Maven<!-- --> Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-github-pages-works-and-how-to-use-it" class="table-of-contents__link toc-highlight">How GitHub Pages works and how to use it</a><ul><li><a href="#deploy" class="table-of-contents__link toc-highlight">Deploy</a></li></ul></li><li><a href="#further-discussion" class="table-of-contents__link toc-highlight">Further discussion</a><ul><li><a href="#manually-deploying-to-a-branch" class="table-of-contents__link toc-highlight">Manually deploying to a branch</a></li><li><a href="#another-method-of-deploying-manually-doesnt-work-well" class="table-of-contents__link toc-highlight">Another method of deploying manually doesn&#39;t work well</a></li><li><a href="#how-github-pages-really-works" class="table-of-contents__link toc-highlight">How GitHub Pages really works</a></li><li><a href="#serving-github-pages-from-a-subdirectory" class="table-of-contents__link toc-highlight">Serving GitHub Pages from a subdirectory</a></li><li><a href="#following-github-conventions" class="table-of-contents__link toc-highlight">Following GitHub conventions</a></li><li><a href="#moving-source-code-back-to-the-master-branch" class="table-of-contents__link toc-highlight">Moving source code back to the master branch</a></li><li><a href="#changing-usernames-or-organization-names" class="table-of-contents__link toc-highlight">Changing usernames or organization names</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docusaurus Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social Media</div><ul class="footer__items"><li class="footer__item"><a href="https://www.facebook.com/william.poetra.yoga" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.instagram.com/williampoetra" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.reddit.com/user/wpyh" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Favourite Sites</div><ul class="footer__items"><li class="footer__item"><a href="https://www.youtube.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">My Websites</div><ul class="footer__items"><li class="footer__item"><a href="https://ipaddr.my.id" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>IP Address Check<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://wpyoga.blogspot.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>My Old Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/wpyoga/wpyoga.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www-uxsup.csx.cam.ac.uk/misc/horror.txt" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Unix Horror Stories<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 William Poetra Yoga / gmail: william dot poetra / gmail: wpyoga86</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4adf4b77.js"></script>
<script src="/assets/js/main.10af240a.js"></script>
</body>
</html>