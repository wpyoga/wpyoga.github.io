"use strict";(self.webpackChunkwpyoga_docusaurus_blog=self.webpackChunkwpyoga_docusaurus_blog||[]).push([[1610],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=o,y=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return n?i.createElement(y,a(a({ref:t},p),{},{components:n})):i.createElement(y,a({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,a[1]=s;for(var c=2;c<r;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4902:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},assets:function(){return p},toc:function(){return d},default:function(){return m}});var i=n(3117),o=n(102),r=(n(7294),n(3905)),a=["components"],s={title:"Hiding Ventoy's second partition",tags:["ventoy","vtoyefi","reserved partition"]},l=void 0,c={permalink:"/blog/2022/05/10/hiding-ventoy-second-partition",editUrl:"https://github.com/wpyoga/wpyoga.github.io/edit/master/blog/2022-05-10-hiding-ventoy-second-partition.md",source:"@site/blog/2022-05-10-hiding-ventoy-second-partition.md",title:"Hiding Ventoy's second partition",description:"When we install Ventoy on a USB stick, it creates 2 partitions: Ventoy and VTOYEFI. We put ISO images into the Ventoy partition, but rarely, if ever, touch the VTOYEFI partition. However, both partitions are mounted every time the USB stick is inserted, be it in Windows or in Linux. My goal is to disable this behaviour, while making sure the USB stick is still fully functional.",date:"2022-05-10T00:00:00.000Z",formattedDate:"May 10, 2022",tags:[{label:"ventoy",permalink:"/blog/tags/ventoy"},{label:"vtoyefi",permalink:"/blog/tags/vtoyefi"},{label:"reserved partition",permalink:"/blog/tags/reserved-partition"}],truncated:!0,authors:[],nextItem:{title:"Linux Mint OEM Kernel",permalink:"/blog/2022/04/27/linux-mint-oem-kernel"}},p={authorsImageUrls:[]},d=[{value:"EFI System",id:"efi-system",children:[],level:2},{value:"Microsoft reserved",id:"microsoft-reserved",children:[],level:2}],u={toc:d};function m(e){var t=e.components,n=(0,o.Z)(e,a);return(0,r.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"When we install Ventoy on a USB stick, it creates 2 partitions: Ventoy and VTOYEFI. We put ISO images into the Ventoy partition, but rarely, if ever, touch the VTOYEFI partition. However, both partitions are mounted every time the USB stick is inserted, be it in Windows or in Linux. My goal is to disable this behaviour, while making sure the USB stick is still fully functional."),(0,r.kt)("h1",{id:"partition-structure"},"Partition structure"),(0,r.kt)("p",null,"The partitions created by Ventoy look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Disk /dev/sdb: 57.31 GiB, 61530439680 bytes, 120176640 sectors\nDisk model:  SanDisk 3.2Gen1\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: gpt\nDisk identifier: A59926BF-48A9-4C4E-8243-F2AD5921CDC2\n\nDevice         Start       End   Sectors  Size Type\n/dev/sdb1       2048 120111063 120109016 57.3G Microsoft basic data\n/dev/sdb2  120111064 120176599     65536   32M Microsoft basic data\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"/dev/sdb1")," is the bigger Ventoy partition, and ",(0,r.kt)("inlineCode",{parentName:"p"},"/dev/sdb2")," is the smaller VTOYEFI partition."),(0,r.kt)("h1",{id:"solution"},"Solution"),(0,r.kt)("p",null,'The solution turns out to be somewhat simple: change the VTOYEFI partition\'s type to "Windows recovery environment". This can be done using ',(0,r.kt)("inlineCode",{parentName:"p"},"fdisk"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Welcome to fdisk (util-linux 2.34).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\n\nCommand (m for help): p\nDisk /dev/sdb: 57.31 GiB, 61530439680 bytes, 120176640 sectors\nDisk model:  SanDisk 3.2Gen1\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: gpt\nDisk identifier: A59926BF-48A9-4C4E-8243-F2AD5921CDC2\n\nDevice         Start       End   Sectors  Size Type\n/dev/sdb1       2048 120111063 120109016 57.3G Microsoft basic data\n/dev/sdb2  120111064 120176599     65536   32M Microsoft basic data\n\nCommand (m for help): t\nPartition number (1,2, default 2): 2\nPartition type (type L to list all types): 14\n\nChanged type of partition 'Microsoft basic data' to 'Windows recovery environment'.\n\nCommand (m for help): w\nThe partition table has been altered.\nSyncing disks.\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You can type ",(0,r.kt)("inlineCode",{parentName:"p"},"L")," when prompted, to see all the different partition types:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre"},"  1 EFI System                     C12A7328-F81F-11D2-BA4B-00A0C93EC93B\n  2 MBR partition scheme           024DEE41-33E7-11D3-9D69-0008C781F39F\n  3 Intel Fast Flash               D3BFE2DE-3DAF-11DF-BA40-E3A556D89593\n  4 BIOS boot                      21686148-6449-6E6F-744E-656564454649\n  5 Sony boot partition            F4019732-066E-4E12-8273-346C5641494F\n  6 Lenovo boot partition          BFBFAFE7-A34F-448A-9A5B-6213EB736C22\n  7 PowerPC PReP boot              9E1A2D38-C612-4316-AA26-8B49521E5A8B\n  8 ONIE boot                      7412F7D5-A156-4B13-81DC-867174929325\n  9 ONIE config                    D4E6E2CD-4469-46F3-B5CB-1BFF57AFC149\n 10 Microsoft reserved             E3C9E316-0B5C-4DB8-817D-F92DF00215AE\n 11 Microsoft basic data           EBD0A0A2-B9E5-4433-87C0-68B6B72699C7\n 12 Microsoft LDM metadata         5808C8AA-7E8F-42E0-85D2-E1E90434CFB3\n 13 Microsoft LDM data             AF9B60A0-1431-4F62-BC68-3311714A69AD\n 14 Windows recovery environment   DE94BBA4-06D1-4D40-A16A-BFD50179D6AC\n 15 IBM General Parallel Fs        37AFFC90-EF7D-4E96-91C3-2D7AE055B174\n 16 Microsoft Storage Spaces       E75CAF8F-F680-4CEE-AFA3-B001E56EFC2D\n 17 HP-UX data                     75894C1E-3AEB-11D3-B7C1-7B03A0000000\n 18 HP-UX service                  E2A1E728-32E3-11D6-A682-7B03A0000000\n 19 Linux swap                     0657FD6D-A4AB-43C4-84E5-0933C84B4F4F\n 20 Linux filesystem               0FC63DAF-8483-4772-8E79-3D69D8477DE4\n ...\n")))),(0,r.kt)("h1",{id:"non-suitable-partition-types-for-vtoyefi"},"Non-suitable partition types for VTOYEFI"),(0,r.kt)("h2",{id:"efi-system"},"EFI System"),(0,r.kt)("p",null,'If we use this partition type, Windows 10 installation cannot proceed. Just after copying initial files, the installer will abort with the error "Windows could not prepare the computer to boot into the next phase of installation."'),(0,r.kt)("h2",{id:"microsoft-reserved"},"Microsoft reserved"),(0,r.kt)("p",null,"Using this partition type, the VTOYEFI partition is not mounted on Linux, but it is still mounted on Windows and shows up on This PC (My Computer). The weird thing is, Disk Management does not show this partition at all."))}m.isMDXComponent=!0}}]);